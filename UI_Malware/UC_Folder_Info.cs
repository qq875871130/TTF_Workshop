using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using TTF_UI.Properties;
using System.IO;
using System.Windows;

namespace TTF_UI
{
    public partial class UC_Folder_Info : UserControl
    {
        public UC_Folder_Info()
        {
            InitializeComponent();
            Form1.instance.SetLanguage(this.Controls);
        }
        


        //存放文件路径
        public string path;

        //存放图片信息
        public Image img1,img2;

        //定义各个作品种类
        public enum appType
        {
            app_CTAS,
            app_C100
        }
        //根据种类变换页面信息与点击事件
        public void SwitchPage(appType type)
        {
            //新建详页控件
            this.Dock = DockStyle.Fill;
          
            //依照种类设置页面
            switch (type)
            {
                case appType.app_CTAS:
                    //改变图片外观
                    this.pic_thum.Image = Resources.icon_CTAS_100px;
                    this.name_c100.Visible = false;
                    this.creater_c100.Visible = false;
                    this.act_c100.Visible = false;
                    this.pic1.Image = Resources.BG_CarStart;
                    this.pic2.Image = Resources.CTAS_Shot;
                    //改变链接路径
                    path = System.Environment.CurrentDirectory + "/Works/CLPA System/CarLicensePlateAnalyzSystem.exe";
                    img1 = Resources.BG_CarStart;
                    img2 = Resources.CTAS_Shot;
                    break;
                case appType.app_C100:
                    //改变图片外观
                    this.pic_thum.Image = Resources.icon_C100_100px;
                    this.name_ctas.Visible = false;
                    this.creater_ctas.Visible = false;
                    this.creater_ctas.Visible = false;
                    this.pic1.Image = Resources.BG_Start;
                    this.pic2.Image = Resources.C100_UI;
                    //改变链接路径
                    path = System.Environment.CurrentDirectory + "/Works/COVID100Days/Corona100days.exe";
                    img1 = Resources.BG_Start;
                    img2 = Resources.C100_UI;
                    break;
                default:
                    break;
            }
        }

        

        private void Btn_start_Click(object sender, EventArgs e)
        {
            if (File.Exists(path))
            {
                System.Diagnostics.Process.Start(path);
            }
            else
            {
                OverrideMessagebox msgb = new OverrideMessagebox();
                string content = Form1.instance.LangNow.Trim() == "Chinese_Simplify" ? "路径不存在！" : Form1.instance.LangNow.Trim() == "Chinese_Tradition" ? "路徑不存在！" : Form1.instance.LangNow.Trim() == "English" ? "FilePath is not exist!" : "路径不存在！";
                msgb.Showmsg(content,null,OverrideMessagebox.MyMsgboxBtns.OK,OverrideMessagebox.MyMsgIcon.Error);
            }
        }


        private void Btn_location_Click(object sender, EventArgs e)
        {
            if (File.Exists(path))
            {
                System.Diagnostics.Process p = new System.Diagnostics.Process();
                DirectoryInfo info = new DirectoryInfo(path);
                string currentDir = info.Parent.FullName;
                p.StartInfo.FileName = currentDir;
                p.Start();
            }
            else
            {
                OverrideMessagebox msgb = new OverrideMessagebox();
                string content = Form1.instance.LangNow.Trim() == "Chinese_Simplify" ? "路径不存在！" : Form1.instance.LangNow.Trim() == "Chinese_Tradition" ? "路徑不存在！" : Form1.instance.LangNow.Trim() == "English" ? "FilePath is not exist!" : "路径不存在！";
                msgb.Showmsg(content,null, OverrideMessagebox.MyMsgboxBtns.OK, OverrideMessagebox.MyMsgIcon.Error);
            }
        }



        #region 设置控件风格
        
        private void pic1_MouseEnter(object sender, EventArgs e)
        {
            pic1.BorderStyle = BorderStyle.Fixed3D;
        }

        private void pic2_MouseEnter(object sender, EventArgs e)
        {
            pic2.BorderStyle = BorderStyle.Fixed3D;
        }

        private void pic1_MouseLeave(object sender, EventArgs e)
        {
            pic1.BorderStyle = BorderStyle.FixedSingle;
        }

        private void pic2_MouseLeave(object sender, EventArgs e)
        {
            pic2.BorderStyle = BorderStyle.FixedSingle;
        }

        private void Btn_start_MouseEnter(object sender, EventArgs e)
        {
            Btn_start.Image = Resources.start_filled;
        }

        private void Btn_location_MouseEnter(object sender, EventArgs e)
        {
            Btn_location.Image = Resources.openfile_filled;
        }

        private void Btn_start_MouseLeave(object sender, EventArgs e)
        {
            Btn_start.Image = Resources.start_ept;
        }

        private void Btn_location_MouseLeave(object sender, EventArgs e)
        {
            Btn_location.Image = Resources.openfile_ept;
        }
        #endregion

        //返回按钮
        private void btnReturn_Click(object sender, EventArgs e)
        {
            UC_Folder.instance.container.Visible = false;
        }

        //打开图片浏览器函数
        public void picDisplay(Image img)
        {
            var browser = new mediabrowser();
            if (img != null)
            {
                browser.loadPic(img);
                browser.ShowDialog();
            }
            else
            {
                OverrideMessagebox msgb = new OverrideMessagebox();
                string content = Form1.instance.LangNow.Trim() == "Chinese_Simplify" ? "路径不存在！" : Form1.instance.LangNow.Trim() == "Chinese_Tradition" ? "路徑不存在！" : Form1.instance.LangNow.Trim() == "English" ? "FilePath is not exist!" : "路径不存在！";
                msgb.Showmsg(content,null,OverrideMessagebox.MyMsgboxBtns.OK, OverrideMessagebox.MyMsgIcon.Error);
            }
        }

        //按钮打开图片
        private void pic1_DoubleClick(object sender, EventArgs e)
        {
            picDisplay(img1);
        }

        private void pic1_Click(object sender, EventArgs e)
        {

        }

        private void pic2_DoubleClick(object sender, EventArgs e)
        {
            picDisplay(img2);
        }
    }
}
